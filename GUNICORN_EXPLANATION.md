# Gunicornとは？WSGIサーバーとは？

## 🤔 質問：gunicorn - 本番環境でのWSGIサーバー ってどういうこと？

## 📚 基本概念

### 開発環境 vs 本番環境

#### 開発環境（開発中）
- 自分のPCで `python main.py` を実行
- Flaskの**開発用サーバー**が起動
- `http://localhost:5000` でアクセス
- **1人だけが使う**（自分だけ）

#### 本番環境（実際に公開する）
- サーバー（クラウドなど）にアプリをデプロイ
- **多くの人が同時にアクセス**する
- 開発用サーバーでは**性能が足りない**

## 🔍 WSGIとは？

**WSGI** = **Web Server Gateway Interface**（ウェブサーバーゲートウェイインターフェース）

- PythonのWebアプリケーションとWebサーバーを**つなぐ規格**
- FlaskアプリはWSGI規格に準拠している
- WSGIサーバーがFlaskアプリを実行する

## 🚀 Gunicornとは？

**Gunicorn** = **Green Unicorn**（グリーン・ユニコーン）

- **WSGIサーバー**の一種
- Flaskアプリを**本番環境で動かすためのサーバー**
- 開発用サーバーより**高速で安定**

## 📊 比較表

| 項目 | Flask開発サーバー | Gunicorn |
|------|------------------|----------|
| **用途** | 開発・テスト | 本番環境 |
| **性能** | 低い（1リクエストずつ） | 高い（複数リクエスト同時処理） |
| **安定性** | 低い（開発用） | 高い（本番用） |
| **起動方法** | `python main.py` | `gunicorn main:app` |
| **同時接続** | 1人程度 | 多数のユーザー |

## 💻 実際の使い方

### 開発環境（現在）

```bash
python main.py
```

Flaskの開発サーバーが起動：
```
 * Running on http://127.0.0.1:5000
 * Debug mode: on
```

### 本番環境（デプロイ時）

```bash
gunicorn main:app
```

または、より詳細な設定：

```bash
gunicorn main:app \
  --bind 0.0.0.0:8000 \
  --workers 4 \
  --timeout 120
```

## 🔧 なぜ必要？

### Flask開発サーバーの問題点

1. **1つのリクエストしか処理できない**
   - ユーザーAがアクセス中は、ユーザーBは待たされる
   - 本番環境では**使えない**

2. **性能が低い**
   - 開発用なので、最適化されていない

3. **安定性が低い**
   - エラーが起きやすい
   - 長時間動作させると不安定

### Gunicornの利点

1. **複数のリクエストを同時処理**
   - 複数のワーカー（プロセス）で処理
   - 多くのユーザーが同時にアクセスできる

2. **高性能**
   - 本番環境向けに最適化されている

3. **安定性が高い**
   - 長時間動作しても安定
   - エラーが起きても自動で復旧

## 📝 このアプリでの使用状況

### 現在（開発中）

```python
# main.py の最後
if __name__ == '__main__':
    app.run(debug=True, host='0.0.0.0', port=5000)
```

→ Flaskの開発サーバーを使用

### 本番環境（デプロイ時）

```bash
gunicorn main:app --bind 0.0.0.0:8000
```

→ Gunicornを使用

## 🎯 まとめ

- **WSGI**: PythonのWebアプリとサーバーをつなぐ規格
- **Gunicorn**: 本番環境でFlaskアプリを動かすためのWSGIサーバー
- **開発環境**: Flaskの開発サーバー（`python main.py`）
- **本番環境**: Gunicorn（`gunicorn main:app`）

**簡単に言うと**：
- 開発中は `python main.py` で動かす
- 本番環境（公開する時）は `gunicorn` で動かす
- Gunicornの方が**速くて安定している**

## 💡 補足：requirements.txtに含まれている理由

`requirements.txt`に`gunicorn>=21.2.0`が含まれているのは：
- 本番環境にデプロイする時に必要
- 開発環境では使わないが、**準備として含めておく**

開発中は使わなくてもOKです！

